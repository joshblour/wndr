<!DOCTYPE html>
<html>
<head></head>
<body>
<script type="text/javascript">
/// / KUDOS: http://stackoverflow.com/a/8237102/1202726
// // if iPod / iPhone, display install app prompt
// var redirect_url = 'http://www.wandertheapp.com';
// if (navigator.userAgent.match(/(iPhone|iPod|iPad);?/i))  {
//   var store_loc = "https://itunes.apple.com/app/id982264776";
//   if (location.hash) {
//     var app_loc = "wander://" + location.hash.substring(1);
// 	var timeout;
//
// 	function preventPopup() {
// 	    clearTimeout(timeout);
// 	    timeout = null;
// 	    window.removeEventListener('pagehide', preventPopup);
// 	}
//
// 	function openApp() {
// 	    if(/OS [2-8]_\d(_\d)? like Mac OS X/i.test(navigator.userAgent)) {
// 	        // iOS 2-8
// 	        var iframe = document.createElement("iframe");
// 	        iframe.src = app_loc;
// 	        document.body.appendChild(iframe);
// 	    } else {
// 	        // iOS 9 or Newer
// 			window.location.href = app_loc;
// 	    }
//
// 	    timeout = setTimeout(function() {
// 	            document.location = store_loc;
// 	    }, 500);
// 	    window.addEventListener('pagehide', preventPopup);
// 	}
//
// 	openApp();
//
//   } else {
//     window.location = redirect_url;
//   }
// } else {
//   window.location = redirect_url;
// }

var custom = "wander://add";
var alt = "http://www.wandertheapp.com";
var g_intent = "intent://scan/#Intent;scheme=wander;package=com.joshblour.proximator.android;end";
var timer;
var heartbeat;
var iframe_timer;

function clearTimers() {
    clearTimeout(timer);
    clearTimeout(heartbeat);
    clearTimeout(iframe_timer);
}

function intervalHeartbeat() {
    if (document.webkitHidden || document.hidden) {
        clearTimers();
    }
}

function tryIframeApproach() {
    var iframe = document.createElement("iframe");
    iframe.style.border = "none";
    iframe.style.width = "1px";
    iframe.style.height = "1px";
    iframe.onload = function () {
        document.location = alt;
    };
    iframe.src = custom;
    document.body.appendChild(iframe);
}

function tryWebkitApproach() {
    document.location = custom;
    timer = setTimeout(function () {
        document.location = alt;
    }, 2500);
}

function useIntent() {
    document.location = g_intent;
}

function launch_app_or_alt_url(el) {
    heartbeat = setInterval(intervalHeartbeat, 200);
    if (navigator.userAgent.match(/Chrome/)) {
        useIntent();
    } else if (navigator.userAgent.match(/Firefox/)) {
        tryWebkitApproach();
        iframe_timer = setTimeout(function () {
            tryIframeApproach();
        }, 1500);
    } else {
        tryIframeApproach();
    }
}

    launch_app_or_alt_url();

</script>
Opening app...
</body>
</html>
